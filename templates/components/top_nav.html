{% load static %}
<nav class="top-nav" data-participant-type="{{ user_type }}">
    <div class="nav-left">
        <button class="menu-toggle-btn" id="menuIcon">
            <span></span>
            <span></span>
            <span></span>
        </button>
        {% if user_type == 'patient' %}
            <button class="nav-back-btn" onclick="window.location.href='/patient/dashboard/'">←</button>
        {% elif user_type == 'doctor' %}
            <button class="nav-back-btn" onclick="window.location.href='/doctor/dashboard/'">←</button>
        {% elif user_type == 'hospital' %}
            <button class="nav-back-btn" onclick="window.location.href='/hospital/dashboard/'">←</button>
        {% elif user_type == 'pharmacy' %}
            <button class="nav-back-btn" onclick="window.location.href='/pharmacy/dashboard/'">←</button>
        {% elif user_type == 'insurance' %}
            <button class="nav-back-btn" onclick="window.location.href='/insurance/dashboard/'">←</button>
        {% elif user_type == 'receptionist' %}
            <button class="nav-back-btn" onclick="window.location.href='/hospital/staff/receptionist/dashboard/'">←</button>
        {% elif user_type == 'nurse' %}
            <button class="nav-back-btn" onclick="window.location.href='/hospital/staff/nurse/dashboard/'">←</button>
        {% elif user_type == 'lab_technician' %}
            <button class="nav-back-btn" onclick="window.location.href='/hospital/staff/lab-technician/dashboard/'">←</button>
        {% elif user_type == 'hospital_pharmacist' %}
            <button class="nav-back-btn" onclick="window.location.href='/hospital/staff/pharmacist/dashboard/'">←</button>
        {% elif user_type == 'hospital_administrator' %}
            <button class="nav-back-btn" onclick="window.location.href='/hospital/staff/administrator/dashboard/'">←</button>
        {% elif user_type == 'pharmacy_pharmacist' %}
            <button class="nav-back-btn" onclick="window.location.href='/pharmacy/staff/pharmacist/dashboard/'">←</button>
        {% elif user_type == 'pharmacy_cashier' %}
            <button class="nav-back-btn" onclick="window.location.href='/pharmacy/staff/cashier/dashboard/'">←</button>
        {% elif user_type == 'pharmacy_inventory_clerk' %}
            <button class="nav-back-btn" onclick="window.location.href='/pharmacy/staff/inventory-clerk/dashboard/'">←</button>
        {% elif user_type == 'pharmacy_delivery' %}
            <button class="nav-back-btn" onclick="window.location.href='/pharmacy/staff/delivery/dashboard/'">←</button>
        {% elif user_type == 'pharmacy_manager' %}
            <button class="nav-back-btn" onclick="window.location.href='/pharmacy/staff/manager/dashboard/'">←</button>
        {% endif %}
    </div>
    <div class="nav-center">
        <img src="{% static 'img/logo.png' %}" alt="BINTACURA" class="nav-logo-img">
        <span class="nav-page-title">{{ page_title|default:"BINTACURA" }}</span>
    </div>
    <div class="nav-right">
        <!-- Messages Icon with Dropdown -->
        <div class="nav-icon-container" id="messagesIcon" data-participant-type="{{ user_type }}" title="Messages">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
            </svg>
            <span class="nav-badge" id="messagesBadge" style="display: none;">0</span>
            
            <!-- Messages Dropdown Panel -->
            <div class="notification-dropdown-panel" id="messagesPanel" style="display: none;">
                <div class="notification-dropdown-header">
                    <h3>Messages</h3>
                </div>
                <div class="notification-dropdown-content" id="messagesContent">
                    <div class="loading-message">Chargement...</div>
                </div>
                <div class="notification-dropdown-footer">
                    <a href="/messages/">Voir tous les messages</a>
                </div>
            </div>
        </div>
        
        <!-- Notifications Icon with Dropdown -->
        <div class="nav-icon-container" id="notificationsIcon" data-participant-type="{{ user_type }}" title="Notifications">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
            </svg>
            <span class="nav-badge" id="notificationsBadge" style="display: none;">0</span>
            
            <!-- Notifications Dropdown Panel -->
            <div class="notification-dropdown-panel" id="notificationsPanel" style="display: none;">
                <div class="notification-dropdown-header">
                    <h3>Notifications</h3>
                    <button class="mark-all-read-btn" id="markAllReadBtn">Tout marquer comme lu</button>
                </div>
                <div class="notification-dropdown-content" id="notificationsContent">
                    <div class="loading-message">Chargement...</div>
                </div>
                <div class="notification-dropdown-footer">
                    <a href="/notifications/">Voir toutes les notifications</a>
                </div>
            </div>
        </div>
        
        <!-- Participant Avatar -->
        <div class="nav-user-avatar" onclick="window.location.href='/{{ user_type }}/profile/'">
            {% include "components/user_avatar.html" with user=request.user %}
        </div>
    </div>
</nav>

<script src="{% static 'js/top-nav.js' %}"></script>